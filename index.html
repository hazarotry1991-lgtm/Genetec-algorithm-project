

<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختيار الميزات بالخوارزمية الجينية</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            color: #333;
        }
        .header {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .card {
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
            margin-bottom: 20px;
            border: none;
        }
        .card-header {
            background-color: #f1f5ff;
            font-weight: bold;
            border-bottom: 1px solid #e3e9ff;
        }
        .btn-primary {
            background: linear-gradient(to right, #4A00E0, #8E2DE2);
            border: none;
            padding: 10px 20px;
            font-weight: bold;
            width: 100%;
        }
        .btn-primary:hover {
            background: linear-gradient(to right, #3A00C0, #7E1DC2);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .form-control, .form-select {
            margin-bottom: 15px;
            border-radius: 8px;
            padding: 10px;
            border: 1px solid #ced4da;
        }
        .slider-container {
            padding: 15px 0;
        }
        .result-box {
            background-color: #e8f5e9;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            display: none;
        }
        .upload-box {
            border: 2px dashed #6c757d;
            padding: 20px;
            text-align: center;
            border-radius: 10px;
            margin-bottom: 20px;
            background-color: #f8f9fa;
            transition: all 0.3s;
        }
        .upload-box:hover {
            border-color: #4A00E0;
            background-color: #f0f5ff;
        }
        .metric-card {
            background: linear-gradient(135deg, #36D1DC 0%, #5B86E5 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 15px;
        }
        .feature-list {
            max-height: 200px;
            overflow-y: auto;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }
        .spinner {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        .spinner-border {
            width: 3rem; 
            height: 3rem;
            color: #4A00E0;
        }
        .info-box {
            background-color: #e7f3ff;
            padding: 15px;
            border-radius: 8px;
            border-right: 5px solid #4A00E0;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>اختيار الميزات بالخوارزمية الجينية</h1>
            <p>أداة متقدمة لاختيار أفضل مجموعة من الميزات باستخدام الخوارزميات الجينية</p>
        </div>

        <div class="info-box">
            <p>👆 ارفع ملف CSV وحدد عمود الهدف ثم اضغط تشغيل</p>
        </div>

        <div class="row">
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header">
                        تحميل البيانات
                    </div>
                    <div class="card-body">
                        <div class="upload-box" id="uploadBox">
                            <p>اسحب وأفلت ملف CSV هنا أو</p>
                            <input type="file" id="csvFile" class="d-none" accept=".csv">
                            <button class="btn btn-outline-primary" onclick="document.getElementById('csvFile').click()">اختر ملف</button>
                            <p class="small text-muted mt-2">يجب أن يحتوي الملف على عمود الهدف (Target)</p>
                        </div>
                        <div id="fileInfo" class="alert alert-info d-none"></div>
                        
                        <div class="mb-3">
                            <label for="targetColumn" class="form-label">اسم عمود الهدف (Target)</label>
                            <input type="text" class="form-control" id="targetColumn" placeholder="أدخل اسم العمود" value="target">
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        إعدادات النموذج والخوارزمية
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="modelSelect" class="form-label">النموذج</label>
                                    <select class="form-select" id="modelSelect">
                                        <option value="logreg">Regression Logistic</option>
                                        <option value="svm">SVM</option>
                                        <option value="rf">Random Forest</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="mb-3">
                                    <label for="populationSize" class="form-label">حجم السكان (Population)</label>
                                    <input type="number" class="form-control" id="populationSize" min="10" max="500" value="30">
                                </div>
                                <div class="mb-3">
                                    <label for="generations" class="form-label">عدد الأجيال (Generations)</label>
                                    <input type="number" class="form-control" id="generations" min="5" max="200" value="20">
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="slider-container">
                                    <label for="mutationRate" class="form-label">معدل الطفرة (Mutation Rate): <span id="mutationValue">0.05</span></label>
                                    <input type="range" class="form-range" id="mutationRate" min="0" max="0.5" step="0.01" value="0.05">
                                </div>
                                <div class="slider-container">
                                    <label for="crossoverRate" class="form-label">معدل التزاوج (Crossover Rate): <span id="crossoverValue">0.8</span></label>
                                    <input type="range" class="form-range" id="crossoverRate" min="0" max="1" step="0.05" value="0.8">
                                </div>
                            </div>
                        </div>
                        
                        <div class="slider-container">
                            <label for="alpha" class="form-label">وزن الدقة مقابل قلة الميزات (alpha): <span id="alphaValue">0.9</span></label>
                            <input type="range" class="form-range" id="alpha" min="0" max="1" step="0.05" value="0.9">
                        </div>
                        
                        <button id="runButton" class="btn btn-primary mt-3">تشغيل</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="spinner" id="spinner">
            <div class="spinner-border" role="status">
                <span class="visually-hidden">جاري التشغيل...</span>
            </div>
            <p class="mt-2">جاري التشغيل... قد تستغرق العملية بعض الوقت</p>
        </div>

        <div class="result-box" id="resultBox">
            <h3 class="text-success">✅ تم الانتهاء!</h3>
            
            <div class="row mt-4">
                <div class="col-md-4">
                    <div class="metric-card">
                        <h5>دقة الاختبار (تقريبي)</h5>
                        <h2 id="accuracyValue">0.0000</h2>
                    </div>
                </div>
                <div class="col-md-8">
                    <div class="alert alert-secondary">
                        <h5>عدد الميزات المختارة: <span id="featuresCount">0</span> / <span id="totalFeatures">0</span></h5>
                    </div>
                </div>
            </div>
            
            <h4 class="mt-4">فهرس الميزات المختارة</h4>
            <div class="feature-list" id="selectedFeatures">
                // سيتم عرض الميزات المختارة هنا
            </div>
            
            <h4 class="mt-4">تقرير GA</h4>
            <pre class="bg-light p-3 rounded" id="gaReport">// سيتم عرض التقرير هنا</pre>
        </div>
    </div>

    <script>
        // تحديث قيم السلايدرز عند التغيير
        document.getElementById('mutationRate').addEventListener('input', function() {
            document.getElementById('mutationValue').textContent = this.value;
        });
        
        document.getElementById('crossoverRate').addEventListener('input', function() {
            document.getElementById('crossoverValue').textContent = this.value;
        });
        
        document.getElementById('alpha').addEventListener('input', function() {
            document.getElementById('alphaValue').textContent = this.value;
        });
        
        // التعامل مع تحميل الملف
        document.getElementById('csvFile').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                document.getElementById('fileInfo').classList.remove('d-none');
                document.getElementById('fileInfo').textContent = `تم اختيار الملف: ${file.name} (${Math.round(file.size/1024)} KB)`;
                
                // قراءة العناوين لتحديد الأعمدة المتاحة
                const reader = new FileReader();
                reader.onload = function(e) {
                    const text = e.target.result;
                    const firstLine = text.split('\n')[0];
                    const columns = firstLine.split(',');
                    
                    // يمكن استخدام هذه المعلومات لعرض أسماء الأعمدة للمستخدم
                    console.log("أعمدة الملف:", columns);
                };
                reader.readAsText(file);
            }
        });
        
        // التعامل مع زر التشغيل
        document.getElementById('runButton').addEventListener('click', function() {
            const fileInput = document.getElementById('csvFile');
            const targetColumn = document.getElementById('targetColumn').value;
            
            if (!fileInput.files.length) {
                alert('يرجى تحميل ملف CSV أولاً');
                return;
            }
            
            if (!targetColumn) {
                alert('يرجى إدخال اسم عمود الهدف');
                return;
            }
            
            // إظهار مؤشر التحميل
            document.getElementById('spinner').style.display = 'block';
            document.getElementById('resultBox').style.display = 'none';
            
            // محاكاة عملية المعالجة (في التطبيق الحقيقي، سيتم إرسال البيانات إلى الخادم)
            setTimeout(() => {
                // إخفاء مؤشر التحميل
                document.getElementById('spinner').style.display = 'none';
                
                // عرض النتائج (بيانات تجريبية)
                document.getElementById('accuracyValue').textContent = '0.9234';
                document.getElementById('featuresCount').textContent = '12';
                document.getElementById('totalFeatures').textContent = '25';
                document.getElementById('selectedFeatures').innerHTML = 
                    '[0, 3, 5, 7, 8, 9, 12, 15, 17, 19, 21, 23]';
                
                document.getElementById('gaReport').textContent = JSON.stringify({
                    best_fitness: 0.9234,
                    best_individual: [1,0,1,0,1,1,0,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,1,1],
                    generation: 20,
                    avg_fitness: 0.8765,
                    std_fitness: 0.0452
                }, null, 2);
                
                document.getElementById('resultBox').style.display = 'block';
            }, 3000);
        });
        
        // جعل منطقة الرفع قابلة للسحب والإفلات
        const uploadBox = document.getElementById('uploadBox');
        uploadBox.addEventListener('dragover', function(e) {
            e.preventDefault();
            uploadBox.style.borderColor = '#4A00E0';
            uploadBox.style.backgroundColor = '#e8f0ff';
        });
        
        uploadBox.addEventListener('dragleave', function() {
            uploadBox.style.borderColor = '#6c757d';
            uploadBox.style.backgroundColor = '#f8f9fa';
        });
        
        uploadBox.addEventListener('drop', function(e) {
            e.preventDefault();
            uploadBox.style.borderColor = '#6c757d';
            uploadBox.style.backgroundColor = '#f8f9fa';
            
            if (e.dataTransfer.files.length) {
                const file = e.dataTransfer.files[0];
                if (file.name.endsWith('.csv')) {
                    // إنشاء FileList اصطناعي وتعيينه لحقل الإدخال
                    const dataTransfer = new DataTransfer();
                    dataTransfer.items.add(file);
                    document.getElementById('csvFile').files = dataTransfer.files;
                    
                    // تحديث واجهة المستخدم
                    document.getElementById('fileInfo').classList.remove('d-none');
                    document.getElementById('fileInfo').textContent = `تم اختيار الملف: ${file.name} (${Math.round(file.size/1024)} KB)`;
                } else {
                    alert('يرجى تحميل ملف CSV فقط');
                }
            }
        });
    </script>
</body>
</html>


